\section{Exercise 2}
We solve the equation
\[
    y'(t)=-10y^2(t), \quad
    y(0) = 1
\]
with the 4-stage Runge-Kutta method and $h=2^{-k}$, $T=2$, $k=5, \dots, 10$. 
We implement the method as follow.

\begin{lstlisting}[style=Matlab-editor]
function y_est = runge_kutta4(fun, h, T, y_0)
    N = floor(T/h)+1;
    y_est = zeros(length(y_0),N);
    y_est(:,1) = y_0;
    for n = 2:N
        t = n*(h-1);
        k1 = fun(t, y_est(:,n-1));
        k2 = fun(t + h/2, y_est(:,n-1) +1/2 * h * k1);
        k3 = fun(t + h/2, y_est(:,n-1) +1/2 * h * k2);
        k4 = fun(t +h, y_est(:,n-1) + h*k3);
        y_est(:,n) = y_est(:,n-1) + 1/6 * h *(k1+ 2*k2 +2*k3 +k4);
    end
end
\end{lstlisting}

The error for decreasing step size is presented in Figure \ref{fig:ErrorEx02} and summarized in Table \ref{tab:error_table_ex02}. As the step size decreases, so does the error. Moreover, the slope of the line in the log-log plot is approximately $-3.92$ consistent with the method's fourth-order accuracy $O(h^{-4})$.

\begin{minipage}[s]{.49\textwidth}
    \begin{figure}[H] % Forces the figure to stay here
        \centering
        \includegraphics[width=0.9\linewidth]{Pic/ErrorEx02.jpg}
        \caption{RK4 Error Reduction with smaller step size.}
        \label{fig:ErrorEx02}
    \end{figure}
\end{minipage}%
\begin{minipage}[s]{.49\textwidth}
    \begin{table}[H] % Forces the table to stay here
        \centering
        \begin{tabular}{|c|c|}
            \hline
            \textbf{nÂ° of steps} & \textbf{error} \\ \hline
              32  &  $2.29 \cdot 10^{-7}$\\
              64   & $1.78 \cdot10^{-8}$ \\
             128  & $ 1.16 \cdot10^{-9}$\\
            256   & $7.31 \cdot10^{-11}$\\
            512   & $4.58 \cdot10^{-12}$\\
            1024  &  $2.86 \cdot10^{-13}$\\
            \hline
        \end{tabular}
        \caption{Final error with increasing number of steps.}
        \label{tab:error_table_ex02}
    \end{table}
\end{minipage}
